var input = 
[
   {
      "Name":"chevrolet chevelle malibu",
      "Miles_per_Gallon":18,
      "Cylinders":8,
      "Displacement":307,
      "Horsepower":130,
      "Weight_in_lbs":3504,
      "Acceleration":12,
      "Year":"1970-01-01",
      "Origin":"USA"
   },
   {
      "Name":"buick skylark 320",
      "Miles_per_Gallon":15,
      "Cylinders":8,
      "Displacement":350,
      "Horsepower":165,
      "Weight_in_lbs":3693,
      "Acceleration":11.5,
      "Year":"1970-01-01",
      "Origin":"USA"
   },
   {
      "Name":"plymouth satellite",
      "Miles_per_Gallon":18,
      "Cylinders":8,
      "Displacement":318,
      "Horsepower":150,
      "Weight_in_lbs":3436,
      "Acceleration":11,
      "Year":"1970-01-01",
      "Origin":"USA"
   },
   {
      "Name":"amc rebel sst",
      "Miles_per_Gallon":16,
      "Cylinders":8,
      "Displacement":304,
      "Horsepower":150,
      "Weight_in_lbs":3433,
      "Acceleration":12,
      "Year":"1970-01-01",
      "Origin":"USA"
   },
   {
      "Name":"ford torino",
      "Miles_per_Gallon":17,
      "Cylinders":8,
      "Displacement":302,
      "Horsepower":140,
      "Weight_in_lbs":3449,
      "Acceleration":10.5,
      "Year":"1970-01-01",
      "Origin":"USA"
   },
   {
      "Name":"ford galaxie 500",
      "Miles_per_Gallon":15,
      "Cylinders":8,
      "Displacement":429,
      "Horsepower":198,
      "Weight_in_lbs":4341,
      "Acceleration":10,
      "Year":"1970-01-01",
      "Origin":"USA"
   },
   {
      "Name":"chevrolet impala",
      "Miles_per_Gallon":14,
      "Cylinders":8,
      "Displacement":454,
      "Horsepower":220,
      "Weight_in_lbs":4354,
      "Acceleration":9,
      "Year":"1970-01-01",
      "Origin":"USA"
   },
   {
      "Name":"plymouth fury iii",
      "Miles_per_Gallon":14,
      "Cylinders":8,
      "Displacement":440,
      "Horsepower":215,
      "Weight_in_lbs":4312,
      "Acceleration":8.5,
      "Year":"1970-01-01",
      "Origin":"USA"
   },
   {
      "Name":"pontiac catalina",
      "Miles_per_Gallon":14,
      "Cylinders":8,
      "Displacement":455,
      "Horsepower":225,
      "Weight_in_lbs":4425,
      "Acceleration":10,
      "Year":"1970-01-01",
      "Origin":"USA"
   },
   {
      "Name":"amc ambassador dpl",
      "Miles_per_Gallon":15,
      "Cylinders":8,
      "Displacement":390,
      "Horsepower":190,
      "Weight_in_lbs":3850,
      "Acceleration":8.5,
      "Year":"1970-01-01",
      "Origin":"USA"
   },
   {
      "Name":"citroen ds-21 pallas",
      "Miles_per_Gallon":null,
      "Cylinders":4,
      "Displacement":133,
      "Horsepower":115,
      "Weight_in_lbs":3090,
      "Acceleration":17.5,
      "Year":"1970-01-01",
      "Origin":"Europe"
   },
   {
      "Name":"chevrolet chevelle concours (sw)",
      "Miles_per_Gallon":null,
      "Cylinders":8,
      "Displacement":350,
      "Horsepower":165,
      "Weight_in_lbs":4142,
      "Acceleration":11.5,
      "Year":"1970-01-01",
      "Origin":"USA"
   },
   {
      "Name":"ford torino (sw)",
      "Miles_per_Gallon":null,
      "Cylinders":8,
      "Displacement":351,
      "Horsepower":153,
      "Weight_in_lbs":4034,
      "Acceleration":11,
      "Year":"1970-01-01",
      "Origin":"USA"
   },
   {
      "Name":"plymouth satellite (sw)",
      "Miles_per_Gallon":null,
      "Cylinders":8,
      "Displacement":383,
      "Horsepower":175,
      "Weight_in_lbs":4166,
      "Acceleration":10.5,
      "Year":"1970-01-01",
      "Origin":"USA"
   },
   {
      "Name":"amc rebel sst (sw)",
      "Miles_per_Gallon":null,
      "Cylinders":8,
      "Displacement":360,
      "Horsepower":175,
      "Weight_in_lbs":3850,
      "Acceleration":11,
      "Year":"1970-01-01",
      "Origin":"USA"
   },
   {
      "Name":"dodge challenger se",
      "Miles_per_Gallon":15,
      "Cylinders":8,
      "Displacement":383,
      "Horsepower":170,
      "Weight_in_lbs":3563,
      "Acceleration":10,
      "Year":"1970-01-01",
      "Origin":"USA"
   },
   {
      "Name":"plymouth 'cuda 340",
      "Miles_per_Gallon":14,
      "Cylinders":8,
      "Displacement":340,
      "Horsepower":160,
      "Weight_in_lbs":3609,
      "Acceleration":8,
      "Year":"1970-01-01",
      "Origin":"USA"
   },
    {
      "Name":"maxda rx3",
      "Miles_per_Gallon":18,
      "Cylinders":3,
      "Displacement":70,
      "Horsepower":90,
      "Weight_in_lbs":2124,
      "Acceleration":13.5,
      "Year":"1973-01-01",
      "Origin":"Japan"
   },
   {
      "Name":"ford pinto",
      "Miles_per_Gallon":19,
      "Cylinders":4,
      "Displacement":122,
      "Horsepower":85,
      "Weight_in_lbs":2310,
      "Acceleration":18.5,
      "Year":"1973-01-01",
      "Origin":"USA"
   },
   {
      "Name":"mercury capri v6",
      "Miles_per_Gallon":21,
      "Cylinders":6,
      "Displacement":155,
      "Horsepower":107,
      "Weight_in_lbs":2472,
      "Acceleration":14,
      "Year":"1973-01-01",
      "Origin":"USA"
   },
   {
      "Name":"fiat 124 sport coupe",
      "Miles_per_Gallon":26,
      "Cylinders":4,
      "Displacement":98,
      "Horsepower":90,
      "Weight_in_lbs":2265,
      "Acceleration":15.5,
      "Year":"1973-01-01",
      "Origin":"Europe"
   },
   {
      "Name":"chevrolet monte carlo s",
      "Miles_per_Gallon":15,
      "Cylinders":8,
      "Displacement":350,
      "Horsepower":145,
      "Weight_in_lbs":4082,
      "Acceleration":13,
      "Year":"1973-01-01",
      "Origin":"USA"
   },
   {
      "Name":"pontiac grand prix",
      "Miles_per_Gallon":16,
      "Cylinders":8,
      "Displacement":400,
      "Horsepower":230,
      "Weight_in_lbs":4278,
      "Acceleration":9.5,
      "Year":"1973-01-01",
      "Origin":"USA"
   },
   {
      "Name":"fiat 128",
      "Miles_per_Gallon":29,
      "Cylinders":4,
      "Displacement":68,
      "Horsepower":49,
      "Weight_in_lbs":1867,
      "Acceleration":19.5,
      "Year":"1973-01-01",
      "Origin":"Europe"
   },
   {
      "Name":"opel manta",
      "Miles_per_Gallon":24,
      "Cylinders":4,
      "Displacement":116,
      "Horsepower":75,
      "Weight_in_lbs":2158,
      "Acceleration":15.5,
      "Year":"1973-01-01",
      "Origin":"Europe"
   },
   {
      "Name":"audi 100ls",
      "Miles_per_Gallon":20,
      "Cylinders":4,
      "Displacement":114,
      "Horsepower":91,
      "Weight_in_lbs":2582,
      "Acceleration":14,
      "Year":"1973-01-01",
      "Origin":"Europe"
   },
   {
      "Name":"volvo 144ea",
      "Miles_per_Gallon":19,
      "Cylinders":4,
      "Displacement":121,
      "Horsepower":112,
      "Weight_in_lbs":2868,
      "Acceleration":15.5,
      "Year":"1973-01-01",
      "Origin":"Europe"
   },
   {
      "Name":"dodge dart custom",
      "Miles_per_Gallon":15,
      "Cylinders":8,
      "Displacement":318,
      "Horsepower":150,
      "Weight_in_lbs":3399,
      "Acceleration":11,
      "Year":"1973-01-01",
      "Origin":"USA"
   },
   {
      "Name":"saab 99le",
      "Miles_per_Gallon":24,
      "Cylinders":4,
      "Displacement":121,
      "Horsepower":110,
      "Weight_in_lbs":2660,
      "Acceleration":14,
      "Year":"1973-01-01",
      "Origin":"Europe"
   },
   {
      "Name":"toyota mark ii",
      "Miles_per_Gallon":20,
      "Cylinders":6,
      "Displacement":156,
      "Horsepower":122,
      "Weight_in_lbs":2807,
      "Acceleration":13.5,
      "Year":"1973-01-01",
      "Origin":"Japan"
   }

]  

//output = [];
/*
var originObject = {};  // hash map
for (var i=0;i <input.length;i++){
	//output[i] = [];
	for (var j in input[i]){
		//if (input[i][j]==null)
		//	output[i].push(-1);	
		//else 
		//	output[i].push(input[i][j]);

		// check origin array
		if (j=="Origin"){
			var item = input[i][j];
			if (originObject[item]==undefined){
				originObject[item] = [];
			}
			else
				originObject[item].push(input[i]);

		}
	}
}*/

var count = 0;
/*var arr = [];
for (var j in originObject){
	var obj = {};
	obj.newName = j;
	obj.reference = originObject[j];
	arr.push(obj);
}	
arr.sort(function(a,b){
	if (a.newName<b.newName)
		return -1;
	else
		return 1;
})

arr.forEach(function(d,i){
	d.newIndex =i;
})

arr.forEach(function(d,i){
	var name = d.newName;
	var index = d.newIndex;
	originObject[name].forEach(function(d){
		d.Origin = index;
	})
})
*/


var clone = {};
for ( key in  input[0]){
   clone[key] = [];
}
var output = input;
input.forEach(function (d){
    for ( key in d){
        if (clone[key].find(function(it){return it.key == [d[key]];}) == undefined){
            clone[key].push({'key': d[key]});
            //clone[key][d[key]].val = [];
            //clone[key][d[key]].val.push(d);
            //clone[key][d[key]].key = d[key];
        }/*else {
            clone[key][d[key]].val.push(d);
        }*/
    }
});


for (key in clone){
   clone[key].sort(function(a,b){
      if (a.key < b.key)
         return -1;
       else
          return 1;});


   clone[key].forEach(function(d,i){
      if (d.key == null)
         d.newindex = 0;
      else if (isNaN(parseFloat(d.key) )){
         d.newindex = i;
      }else{
         d.newindex = parseFloat(d.key);
      }
   });
}

// output with replaced number
output.forEach(function (d,i){
    for ( k in d){
        output[i][k] = clone[k].find(function(it){return it.key == output[i][k]}).newindex;
    }
});